## [2Week] 한승연
### 👍🏻 1Week 추가과제 👍🏻
<strong>상품</strong>
- [X] Product 엔티티 설계
- [X] 상품 등록
    - GET /product/create
- [X] 상품 리스트
    - GET /product/list
- [X] 상품 상세조회
    - GET /product/{id}
- [X] 상품 수정
    - POST /product/{id}/modify
- [X] 상품 삭제
    - POST /product/{id}/delete

### ⭐️ 2Week 필수과제 ⭐️
<strong>장바구니</strong>
- [X] CartItem 엔티티 설계
- [X] 품목 리스트
    - GET /cart/list
- [X] 품목 추가
    - POST /cart/add/{productId}
- [X] 품목 삭제
    - POST /cart/remove/{productId}

<strong>주문</strong>
- [X] Order, OrderItem 엔티티 설계
- [x] 주문 생성
    - POST /order/create
- [x] 주문 리스트
    - GET /order/list
- [x] 주문 상세
    - GET /order/{id}
- [x] 주문 취소
    - POST /order/{id}/cancel
- [x] CashLog 엔티티 설계
- [x] Toss Payments 연동
- [ ] 결제 처리(진행중)
    - [x] 예치금 전액 결제
        - POST /order/{id}/pay
    - [ ] Toss Payments 카드 결제(진행중)
- [ ] MyBook 엔티티 설계

### 👍🏻 2Week 추가과제 👍🏻
<strong>주문</strong>
- [ ] 환불 처리
    - POST /order/{id}/refund

### 🙈 요구사항 및 접근방법 정리 🙈
> 도서(상품) 관리

-   도서 = 상품
-   도서 등록/수정/삭제 기능은 작가 회원만 이용O(수정/삭제는 본인만 가능)
-   도서 리스트/상세조회 기능은 모두 이용O

----------

-   도서 등록
    -   글 해시태그를 선택하면 내 글 중 해당 해시태그가 붙은 모든 글을 자동으로 1개의 상품으로 등록
    -   [폼] 상품명, 설명, 권장 판매가, 글 해시태그 키워드(id), 도서 해시태그 키워드
        -   설명 부분에 ToastUI Editor 적용X
        -   글 해시태그 키워드는 1개만 선택 가능
        -   여러 개의 도서 해시태그 키워드 등록 가능
        -   해시태그 키워드 & 관련 게시글 개수 표시
            -   QueryDSL 이용
            -   다른 엔티티의 여러 컬럼 값을 select 하기 때문에, List<PostKeyword>로 반환 불가 → PostKeywordDto를 정의해 List<PostKeywordDto> 반환([참고](https://wildeveloperetrain.tistory.com/94))
    -   등록 완료시 도서 상세 페이지로 리다이렉트
-   도서 수정
    -   글 키워드 수정 X
    -   상품명, 가격, 설명, 도서 해시태그 수정 O
    -   수정 완료시 도서 상세페이지로 리다이렉트
-   도서 상세조회
    -   [UI] 상품 랜덤 이미지, 상품명, 작가명, 등록일자, 판매가, 설명, 도서 해시태그 키워드 표시
        -   랜덤 이미지 표시 Unsplash 사용([참고](https://wallel.com/unsplash-%EB%9E%9C%EB%8D%A4-%EC%9D%B4%EB%AF%B8%EC%A7%80-url-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/))
        -   설명 부분에 ToastUI Editor Viwer 적용X
    -   [UI] 작가 본인에게만 수정, 삭제 버튼 표시
    -   미리보기 구현X
-   도서 리스트
    -   [UI] 모든 상품 정보(상품 랜덤 이미지, 상품명, 등록 일자, 작가명, 판매가, 해시태그) 최신순 리스팅
        -   랜덤 이미지 표시 Unsplash 사용
    -   상품명 클릭시 해당 상품 상세조회 페이지로 이동
    -   장바구니 버튼 표시
-   도서 삭제
    -   삭제 버튼 클릭시 confirm 창으로 삭제 여부를 한 번 더 체크
    -   삭제 완료시 상품 리스트로 리다이렉트

> 장바구니

-   장바구니 기능은 로그인한 회원만 이용O

----------

-   품목 리스트
    -   메뉴바의 장바구니 메뉴를 클릭해 장바구니 페이지로 이동
    -   [UI] 상품 정보(상품 랜덤 이미지, 상품명, 작가명, 등록일자, 가격) 표시
        -   랜덤 이미지 표시 Unsplash 사용
        -   장바구니에 담긴 상품이 없을 때는 상품 없음 안내 문구 표시
    -   [UI] 전체 선택 체크박스, 품목 개별 체크박스, 품목 삭제 개별 버튼, 주문하기 버튼 표시
        -   Javascript 로 전체 선택 체크박스와 개별 체크박스 연동
    -   이미지 클릭시 해당 상품 상세조회 페이지로 이동
-   품목 추가
    -   도서 목록 페이지의 각 상품의 장바구니 버튼을 클릭해 장바구니에 품목 추가
    -   회원은 같은 상품 1개만 장바구니에 추가 가능(계속 담아도 최대 수량 = 1개)
    -   품목 추가 완료시 품목 리스트 페이지로 리다이렉트
-   품목 삭제
    -   품목 삭제 버튼 클릭시 confirm 으로 확인 후 삭제
    -   품목 삭제 완료시 품목 리스트 페이지로 리다이렉트

> 주문/결제
-   주문/결제 기능은 로그인한 회원만 이용O
-   주문 리스트/상세조회/취소/결제/환불 처리는 주문자 본인 것만 가능

| 주문 상태 | 설명 |
|--|--|
| 주문 완료 | 주문만 완료한 상태(결제X) |
| 결제 완료 | 주문 후 결제도 완료한 상태 완료 |
| 취소 완료 | 주문 완료상태에서 주문 취소를 한 상태 |
| 환불 완료 | 결제 완료상태에서 환불한 상태 |

----------

-   주문 생성
    -   장바구니 페이지에서 주문할 품목을 선택 → 주문하기 버튼을 클릭 → 주문 생성(단일 주문 미지원)
        -   선택한 cartItemId 들을 String 으로 만들어 주문 생성 폼 발송
        -   ‘,’ 기준으로 분리한 CartItemIds String[] → List<String> 으로 변환([참고](https://velog.io/@jwkim/java-arraylist-array-type-conversion))
-   주문 리스트
    -   회원 본인의 주문 내역 최신순 리스팅
    -   [UI] 주문일자, 주문 상태, 주문 품목들 정보(상품 랜덤 이미지, 상품명, 가격) 표시
-   주문 상세
    -   [UI] 주문 상품 정보(상품 랜덤 이미지, 상품명, 가격), 주문 정보(회원 id, 총 상품수, 총 상품금액) 표시
    -   접근 방식 2가지
        1.  장바구니 페이지에서 주문하기 버튼 클릭
        2.  주문내역 페이지에서 상세보기 버튼 클릭
    -   주문 완료 상태
        -   [UI] 보유 예치금 표시
        -   [UI] 주문 취소 버튼, 결제 하기 버튼 표시
    -   결제 완료 상태
        -   [UI] 환불하기 버튼 표시
    -   취소 완료/환불 완료 상태
        -   정보 외에 아무것도 표시X
-   주문 취소
    -   주문 완료 상태일 때만 주문 취소 요청 가능
    -   취소 완료시 주문 내역 페이지로 리다이렉트
-   결제 처리
    -   주문 상세페이지에서 결제 버튼 클릭시 결제 요청(주문 생성후 미결제상태일 때만 요청 가능, 취소/환불 시 요청 불가)
    -   Toss Payments 연동([참고](https://docs.tosspayments.com/guides/windows/card))
    -   3가지 결제 방식 지원
        -   예치금 전액 결제(PG 결제 skip)
        -   Toss Payments 카드 전액 결제(예치금 충전 기록 보존)
        -   예치금 + Toss Payments 카드 결제(혼합 방식)


### ❗️ 특이사항 ❗️
<strong>아쉬웠던 점</strong>
저번주 추가과제인 상품을 구현하면서 하루가 지나갔고 나머지 이틀동안 주문/결제를 하는데 생각보다 시간이 많이 부족했던 것 같다. 그렇다보니 예외처리를 제대로 하지 못했고 테스트 코드를 짜지 못해서 아쉬웠다. 주문 생성을 구현하면서 시간이 꽤 오래걸렸던 것 같다. 엔티티 관계도 복잡하고 필드도 많은데다가 각 필드가 무엇을 의미하고 왜 사용하는지? 등.. 개념적인 부분에서 이해하는데 어려움이 있었다. 스스로 모든 로직을 짜는데 아직은 어려움이 있어서 이전에 했던 프로젝트 코드를 많이 참고했던 것 같다. 

<strong>궁금했던 점</strong>
- productKeyword 삭제 시점은 언제인가(해당 키워드를 사용하는 글이 아무것도 없을 때?)
- 이미 상품화한 글은 다시 상품화 불가능한지(현재는 상품화 계속 가능)
- 본인이 등록한 상품은 구매할 수 없도록 해야하는지
- 이미 주문한 상품은 다시 주문하지 못하도록 해야하는지
- Order 엔티티의 readyStatus 는 정확히 무엇을 의미하는지(주문이 생성되면 무조건 true이고 이후에는 바뀌지 않아야하는 값인지)

<strong>Refactoring</strong>
- 상품, 장바구니, 주문 서비스 테스트 코드 작성
- 예외처리
- 장바구니 선택 삭제 방식 지원(현재는 단일 삭제 방식만 지원)
- 글 해시태그 입력 Tagify 적용
- 메인 페이지(최신글 100개) 구현
- 도서 등록 요청시 작가 회원 되기 페이지로 리다이렉트 하고 싶음
- 상품을 장바구니에 담을 때 장바구니 페이지로 리다이렉트 여부를 물어보고 싶음
- 일반 회원이 도서 등록 요청시 작가 회원 되기 페이지로 리다이렉트 하고 싶음
